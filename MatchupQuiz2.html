<!doctype html>
<html lang="en">
<head>

<!-- reminder to self: JSLint -->

<title>A jQuery Drag-and-Drop Number Cards Game</title>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="style.css">
<link rel="stylesheet" type="text/css" href="dialog.css">
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.9/jquery-ui.min.js"></script>
<!--<script type="text/javascript" src="jquery.ui.mouse.touch.js"></script> -->
<script type="text/javascript" src="dialog.js"></script>
<script type="text/javascript">

var MUquizParams = new Object();
MUquizParams.immediateFeedback = false; // true means something turns green at time of the drop
MUquizParams.gradeMode = false; // false means this is a self-test
MUquizParams.correctCount = 0;

var correctCards = 0;  // init
$( init );
///$( initDialogBox );

function init() {
	// Hide the success message
	$('#successMessage').hide();
	$('#successMessage').css( {
		left: '580px',
		top: '250px',
		width: 0,
		height: 0
	} );

	// Reset the card game
	correctCards = 0;
	nSources = 6;
	nDraggables = nSources;
	nZones = 5;
	$('#home').html( '' );
	$('#cardSlots').html( '' );

	// Create the pile of shuffled cards
	var text = ['bir', 'iki', 'üç', 'dört', 'beş', 'altı' ];
	var numbers = [ 0, 1, 2, 3, 4, 5 ];
	numbers.sort( function() { return Math.random() - .5 } );
	

//	for ( var i=0; i<nSources; i++ ) {
//		$('<div>' + i + '</div>')
//		.data( 'number', i )
//		.attr( 'id', 'card'+numbers[i] )
//		.appendTo( '#home' )
//		.droppable( {
//			accept: '#cardSlots `div',
//			hoverClass: 'hovered',
//			drop: handleReturn
//		} );
//	}
	
	for ( var i=0; i<nDraggables; i++ ) {
		$('<div>' + text[numbers[i]] + '</div>')
		.data( 'number', numbers[i] )
		.attr( 'id', 'draggable' )
		.appendTo( '#home' )
		.draggable( {
			containment: '#quiz',
			stack: '#home div',
			cursor: 'move',
			revert: true
		} );
	}

	var words = [ 'one', 'two', 'three', 'four', 'five'];
	for ( var i=0; i<nZones; i++ ) {
		$('<div>' + words[i] + '</div>')
		.data( 'number', i )
		.appendTo( '#cardSlots' )
		.droppable( {
			accept: '#home div',
			hoverClass: 'hovered',
			drop: handleDrop
		} );
	}
}

function handleReturn( event, ui ) {
	var slotNumber = $(this).data( 'number' );
	var cardNumber = ui.draggable.data( 'number' );
	
	ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
	ui.draggable.draggable( 'option', 'revert', false );
}

function handleDrop( event, ui ) {
	var slotNumber = $(this).data( 'number' );
	var cardNumber = ui.draggable.data( 'number' );

	// If the card was dropped to the correct slot,
	// change the card colour, position it directly
	// on top of the slot, and prevent it being dragged again

	if ( slotNumber == cardNumber) {
//		ui.draggable.addClass( 'correct' );
//		ui.draggable.draggable( 'disable' );
//		$(this).droppable( 'disable' );
		ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
		ui.draggable.draggable( 'option', 'revert', false );
		correctCards++;
	} else if (!immediateFeedback) {
//		ui.draggable.draggable( 'disable' );
//		$(this).droppable( 'disable' );
		ui.draggable.position( { of: $(this), my: 'left top', at: 'left top' } );
		ui.draggable.draggable( 'option', 'revert', false );
	}

	// If all the cards have been placed correctly then display a message
	// and reset the cards for another go

//	if ( correctCards == nZones ) {
//		$('#successMessage').show();
//		$('#successMessage').animate( {
//			left: '380px',
//			top: '200px',
//			width: '400px',
//			height: '100px',
//			opacity: 1
//		} );
//	}
}

function check() {
	if ( correctCards == nZones ) {
		$('#successMessage').show();
		$('#successMessage').animate( {
			left: '380px',
			top: '200px',
			width: '400px',
			height: '100px',
			opacity: 1
		} );
	} else {
		popup("this is a test");
	}
}

</script>

</head>
<body>

<div class="wideBox">
	<h1>Drag-and-Drop Matchup Quiz</h1>
	<h2>Vocabulary example</h2>
</div>

<div id="quiz">
	<div id="matchUp">
		<table id='1'>
			<tr>
				<td>
					<table>
						<tr><td><div class='q' id='1'>question 1</div></td><td><div class='target' id='1'></div></td></tr>
						<tr><td><div class='q' id='2'>question 2</div></td><td><div class='target' id='2'></div></td></tr>
						<tr><td><div class='q' id='3'>question 3</div></td><td><div class='target' id='3'></div></td></tr>
					</table>
				</td>
				<td>
					<table>
						<tr><td><div class='source' id='1'></div></td></tr> <!-- add via js: <div class='choice' id='1'>choice 1</div> -->
						<tr><td><div class='source' id='2'></div></td></tr> <!-- add via js: <div class='choice' id='1'>choice 1</div> -->
						<tr><td><div class='source' id='3'></div></td></tr> <!-- add via js: <div class='choice' id='1'>choice 1</div> -->
						<tr><td><div class='source' id='4'></div></td></tr> <!-- add via js: <div class='choice' id='1'>choice 1</div> -->
					</table>
				</td>
			</tr>	
		</table>
	</div>
	
	<div id="home"> </div>
	<div id="cardSlots"> </div>
	
	<div id="successMessage">
		<h2>You did it!</h2>
		<button onclick="init()">Play Again</button>
	</div>
	<div><button onclick="check()">Check my answers</button></div>
</div>

<div class="wideBox">
	<p>Adapted from the Elated.com example <a href="http://www.elated.com/articles/drag-and-drop-with-jquery-your-essential-guide/">here</a></p>
	
</div>

<!-- Dialog box - initially hidden via dialog.css, call with popup("message") in dialog.js -->
<div id="dialog-overlay"></div>
<div id="dialog-box">
    <div class="dialog-content">
        <div id="dialog-message"></div>
        <a href="#" class="button">Close</a>
    </div>
</div>
</body>
</html>
